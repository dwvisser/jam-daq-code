<?xml version="1.0" encoding="UTF-8"?>
<project name="Jam Project" default="all">

    <property name="base.dir" value="." />
    <property name="build.dir" value="${user.home}/jambuild" />
    <property name="osx.dir" value="${build.dir}/jamosx"></property>
    
    <target name="prepare" depends="clean">
        <mkdir dir="${build.dir}" />
        <mkdir dir="${osx.dir}" />
    </target>
    
    <target name="clean">
    	<delete >
    		<fileset
    			dir="${base.dir}"
    			includes="**\*.bak"
    		/>
    		</delete>
    		<delete dir="${build.dir}"></delete>
    </target>
    
    <target name="jar" depends="prepare">
        <jar jarfile="${build.dir}/Jam.jar"
            basedir="${base.dir}"
            excludes="*.xml,*.jardesc,*.jar,help\API\**\*,jam\**\*.java,jam\**\*.html,jam\**\*.chk,jam\**\*.bak,.classpath,.project"
        />    
    </target>

    <target name="srcjar" depends="prepare">
        <jar jarfile="${build.dir}/JamSrc.jar"
            basedir="${base.dir}"
            includes="jam\**\*.java"
        />    
    </target>
    
    <target name="apijar" depends="prepare">
        <jar jarfile="${build.dir}/JamSrc.jar"
            basedir="${base.dir}"
            includes="help\API\**\*"
        />    
    </target>
    
    <target name="copy" depends="prepare">
        <copy todir="${build.dir}" flatten="true" >
            <fileset dir = "${base.dir}"
                includes="*.jar,*.txt,*.html,help/config/*.ini" >
            </fileset>
        </copy>
    </target>
    
    <target name="osxpackage" depends="javadoc,jar,srcjar">
        <copy todir="${osx.dir}" flatten="true" >
        	<fileset dir = "${base.dir}"
                includes="*.txt,*.html,help/config/*.ini" >
            </fileset>
        </copy>
        <copy todir="${osx.dir}" flatten="false" >
        	<fileset dir = "${base.dir}/OSXpackage"
        		includes="**/*" >
        	</fileset>
        	<fileset dir= "${build.dir}" includes="JamSrc.jar"></fileset>
        </copy>
        <copy todir="${osx.dir}/Jam.app/Contents/Resources/Java" >
        	<fileset dir="${base.dir}" 
        		includes="*.jar"  >
        	</fileset>
        	<fileset dir= "${build.dir}" includes="Jam.jar"></fileset>
        </copy>
        <zip basedir="${build.dir}" zipfile="${build.dir}/Jam-version-MacOSX.zip"
        	includes="jamosx/**/*" >
        </zip>
        <delete dir="${osx.dir}" />
    </target>
    	
    
    <target name="javadoc">
        <javadoc
            destdir="${base.dir}\help\API"
            access="protected" use="true" notree="false"
            nonavbar="false" noindex="false" splitindex="true"
            author="true" version="true" nodeprecatedlist="false"
            nodeprecated="false"
            packagenames="jam.io,jam.data.control,jam.io.hdf,jam.data.peaks,jam.global,jam.fit,jam.util,jam.sort,jam,jam.data.func,jam.sort.stream,jam.plot,jam.data,jam.applet"
            sourcepath="${base.dir}"
            classpath="${base.dir};${base.dir}\jlfgr-1_0.jar;${base.dir}\junit.jar;${base.dir}\jh.jar" 
            	doctitle="Jam - API"/>
    </target>

    
    <target name="all" depends="copy,osxpackage" />
        
</project>
